import{j as e,u as w,r as y,C as E}from"./index-DvfI50mZ.js";import{M,a as S,b as k}from"./bottom-navigation-7WT2ED68.js";import{M as A}from"./mobile-header-Do9qfRWs.js";import{M as u}from"./mobile-button-DZJkoi57.js";import"./mobile-input-jpi_8qGO.js";import{m as x,a as B}from"./mock-data-DPUcImiK.js";import{M as m,u as p}from"./mock-api-DSyZqBbw.js";import{Q as h}from"./qr-code-Dp-kBiEB.js";import{C as f}from"./clock-CW01Z2g7.js";import{C as R}from"./circle-x-C0tIkiuL.js";import"./credit-card-DfOMiA1p.js";import"./user-DQ_JBjmj.js";import"./toast-BrpPLZSF.js";function I({categories:i,selectedCategory:t,onCategoryChange:a}){return e.jsx("div",{className:"flex space-x-2 overflow-x-auto pb-2",children:i.map(n=>e.jsxs("button",{onClick:()=>a(n.id),className:`flex-shrink-0 px-4 py-2 rounded-full text-sm font-medium transition-colors ${t===n.id?"bg-[#EC1B2E] text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:[e.jsx("span",{className:"mr-2",children:n.icon}),n.name]},n.id))})}class g{static async getCoupons(t){let a=[...x];if(t?.search){const l=t.search.toLowerCase();a=a.filter(d=>d.title.toLowerCase().includes(l)||d.description.toLowerCase().includes(l))}t?.category&&(a=a.filter(l=>l.category===t.category)),t?.status&&(a=a.filter(l=>l.status===t.status));const n=t?.page||1,r=t?.limit||10,o=(n-1)*r,C=o+r,c=a.slice(o,C);return m.get("/coupons",t).then(l=>({...l,data:c,pagination:{page:n,pageSize:r,total:a.length,pageCount:Math.ceil(a.length/r)}}))}static async getCoupon(t){const a=x.find(n=>n.id===t);if(!a)throw new Error("Coupon not found");return m.get(`/coupons/${t}`).then(n=>({...n,data:a}))}static async claimCoupon(t){const a=x.find(r=>r.id===t);if(!a)throw new Error("Coupon not found");if(a.status!=="available")throw new Error("Coupon is not available");const n={...a,status:"claimed",claimedAt:new Date().toISOString()};return m.post(`/coupons/${t}/claim`,n).then(r=>({...r,data:n}))}static async useCoupon(t,a){const n=x.find(o=>o.id===t);if(!n)throw new Error("Coupon not found");if(n.status!=="claimed")throw new Error("Coupon is not claimed");const r={...n,status:"used",usedAt:new Date().toISOString(),storeId:a};return m.post(`/coupons/${t}/use`,r).then(o=>({...o,data:r}))}static async getAvailableCoupons(t){return this.getCoupons({...t,status:"available"})}static async getClaimedCoupons(t){return this.getCoupons({...t,status:"claimed"})}static async getUsedCoupons(t){return this.getCoupons({...t,status:"used"})}}function $(i){return p("coupons",{...i,status:"available"},()=>g.getAvailableCoupons(i))}function L(i){return p("coupons",{...i,status:"claimed"},()=>g.getClaimedCoupons(i))}function Q(i){return p("coupons",{...i,status:"used"},()=>g.getUsedCoupons(i))}function T(){const i=w(),[t,a]=y.useState("2"),{data:n}=$(),{data:r}=L(),{data:o}=Q(),c=(()=>{switch(t){case"1":return[...n?.data||[],...r?.data||[],...o?.data||[]];case"2":return[...r?.data||[],...o?.data||[]];case"3":return o?.data||[];case"4":return o?.data||[];default:return[]}})(),l=s=>{i.navigate({to:`/coupon/${s}`})},d=s=>{i.navigate({to:"/coupon/qrcode",search:{couponId:s}})},j=s=>{},b=s=>{switch(s){case"available":return e.jsx(h,{className:"w-4 h-4"});case"claimed":return e.jsx(f,{className:"w-4 h-4"});case"used":return e.jsx(E,{className:"w-4 h-4"});case"expired":return e.jsx(R,{className:"w-4 h-4"});default:return e.jsx(h,{className:"w-4 h-4"})}},N=s=>{switch(s){case"available":return"‡∏£‡∏±‡∏ö‡πÑ‡∏î‡πâ";case"claimed":return"‡∏£‡∏±‡∏ö‡πÅ‡∏•‡πâ‡∏ß";case"used":return"‡πÉ‡∏ä‡πâ‡πÅ‡∏•‡πâ‡∏ß";case"expired":return"‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏";default:return"‡πÑ‡∏°‡πà‡∏ó‡∏£‡∏≤‡∏ö"}},v=s=>{switch(s){case"available":return"bg-green-100 text-green-700";case"claimed":return"bg-blue-100 text-blue-700";case"used":return"bg-gray-100 text-gray-700";case"expired":return"bg-red-100 text-red-700";default:return"bg-gray-100 text-gray-700"}};return e.jsxs(M,{children:[e.jsx(A,{title:"‡∏Ñ‡∏π‡∏õ‡∏≠‡∏á‡∏Ç‡∏≠‡∏á‡∏â‡∏±‡∏ô",showMoreMenu:!0}),e.jsx(S,{className:"pb-20",children:e.jsxs("div",{className:"space-y-6",children:[e.jsx(I,{categories:B,selectedCategory:t,onCategoryChange:a}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx("div",{className:"bg-white rounded-2xl p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"‡∏Ñ‡∏π‡∏õ‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏ö‡πÑ‡∏î‡πâ"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:n?.data?.length||0})]}),e.jsx(h,{className:"w-8 h-8 text-green-600"})]})}),e.jsx("div",{className:"bg-white rounded-2xl p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"‡∏Ñ‡∏π‡∏õ‡∏≠‡∏á‡∏Ç‡∏≠‡∏á‡∏â‡∏±‡∏ô"}),e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:r?.data?.length||0})]}),e.jsx(f,{className:"w-8 h-8 text-blue-600"})]})})]}),e.jsx("div",{className:"space-y-4",children:c.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-4 bg-gray-100 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-2xl",children:"üé´"})}),e.jsx("p",{className:"text-lg font-medium text-gray-900 mb-2",children:"‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ñ‡∏π‡∏õ‡∏≠‡∏á"}),e.jsx("p",{className:"text-gray-500",children:"‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ñ‡∏π‡∏õ‡∏≠‡∏á‡πÉ‡∏ô‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡∏ô‡∏µ‡πâ"})]}):c.map(s=>e.jsx("div",{className:"bg-white rounded-2xl p-4",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-[#EC1B2E] to-[#C20010] rounded-xl flex items-center justify-center",children:e.jsx("span",{className:"text-white text-2xl",children:"üé´"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:s.title}),e.jsxs("span",{className:`px-2 py-1 rounded-full text-xs font-medium flex items-center space-x-1 ${v(s.status)}`,children:[b(s.status),e.jsx("span",{children:N(s.status)})]})]}),e.jsx("p",{className:"text-gray-600 text-sm mb-3",children:s.description}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-gray-500",children:[s.storeName&&e.jsxs("p",{children:["‡∏£‡πâ‡∏≤‡∏ô: ",s.storeName]}),s.remainingTime&&e.jsxs("p",{children:["‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡πÄ‡∏ß‡∏•‡∏≤: ",Math.floor(s.remainingTime/3600)," ‡∏ä‡∏°. ",Math.floor(s.remainingTime%3600/60)," ‡∏ô‡∏≤‡∏ó‡∏µ"]})]}),e.jsxs("div",{className:"flex space-x-2",children:[s.status==="available"&&e.jsx(u,{size:"sm",onClick:()=>j(s.id),children:"‡∏£‡∏±‡∏ö‡∏Ñ‡∏π‡∏õ‡∏≠‡∏á"}),s.status==="claimed"&&e.jsx(u,{size:"sm",onClick:()=>d(s.id),children:"‡πÉ‡∏ä‡πâ‡∏Ñ‡∏π‡∏õ‡∏≠‡∏á"}),e.jsx(u,{variant:"outline",size:"sm",onClick:()=>l(s.id),children:"‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î"})]})]})]})]})},s.id))}),e.jsxs("div",{className:"bg-gradient-to-r from-[#EC1B2E] to-[#C20010] rounded-2xl p-4 text-white text-center",children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"‡∏™‡πÅ‡∏Å‡∏ô‡∏£‡∏±‡∏ö‡∏Ñ‡∏π‡∏õ‡∏≠‡∏á"}),e.jsx("p",{className:"text-white/90 text-sm mb-4",children:"‡∏™‡πÅ‡∏Å‡∏ô QR Code ‡∏ó‡∏µ‡πà‡∏£‡πâ‡∏≤‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏£‡∏±‡∏ö‡∏Ñ‡∏π‡∏õ‡∏≠‡∏á"}),e.jsxs(u,{variant:"outline",className:"bg-white text-[#EC1B2E] hover:bg-gray-100",onClick:()=>i.navigate({to:"/coupon/scan"}),children:[e.jsx(h,{className:"w-4 h-4 mr-2"}),"‡πÄ‡∏õ‡∏¥‡∏î‡∏Å‡∏•‡πâ‡∏≠‡∏á‡∏™‡πÅ‡∏Å‡∏ô"]})]})]})}),e.jsx(k,{currentPath:"/coupon"})]})}const K=T;export{K as component};
